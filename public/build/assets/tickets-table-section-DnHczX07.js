import{u as m,r as C,j as t,A as d}from"./app-B6Ttdtr0.js";import{h as F}from"./moment-C5S46NFB.js";import{T as R}from"./table-BtC5ayvO.js";import{P as _}from"./pagination-DAr8y14S.js";import D from"./tickets-search-section-8ri9BoA2.js";import T from"./tickets-filter-by-date-CEYR50kE.js";import{S as f}from"./index-zBndjqtU.js";import{F as L,R as U,a as $}from"./FieldTimeOutlined-DHmsUiad.js";import{F as A}from"./XMarkIcon-x6EEwyvc.js";import{F as I}from"./ExclamationTriangleIcon-WZzEZxh1.js";import{F as z}from"./TicketIcon-QRhgM9ft.js";import"./tickets-thunk-D9vHGgUs.js";import"./ticket-service-DJcxKhLj.js";import"./AntdIcon-eRVxngrf.js";import"./index-B55d8Cfg.js";import"./index-9aFyH2tt.js";import"./PurePanel-_9pE5wN3.js";import"./ContextIsolator-BFihYbHP.js";import"./button-CSFOOuKo.js";import"./CheckOutlined-DM6qyx1h.js";import"./index-Dy80wF40.js";import"./roundedArrow-BZ2cUF3h.js";import"./motion-Bxwb7-zQ.js";function ce(){var g;const{tickets:i}=m(e=>e.tickets),{categories:n}=m(e=>e.category),{users:o}=m(e=>e.it),[w,j]=C.useState([]),y=window.location.pathname+window.location.search;console.log("categoriescategories",n);const b=new URL(window.location.href),u=new URLSearchParams(b.search);u.get("page");const v=u.get("category_id")||null;function N(e){const a=new URLSearchParams(window.location.search);a.set("category_id",e||"null"),d.visit(window.location.pathname+"?"+a.toString())}const S=Object.values(n.data).map(e=>({label:e.name,value:e.id})),r=Object.values(n.data).find(e=>e.id==v),P=[{title:"Name of Requestor",key:"name"},{title:"Ticket No.",key:"ticket_id"},{title:t.jsx("div",{className:"flex gap-3 items-center justify-center",children:t.jsx(f,{allowClear:!0,className:"w-40 mr-4",showSearch:!0,placeholder:"I.T Personnel",optionFilterProp:"label",defaultValue:(o==null?void 0:o.name)??null,onChange:e=>setData({...p,assigned_to:e}),options:[{value:"",label:"SCIT Department"},...(g=o==null?void 0:o.data)==null?void 0:g.map(e=>({value:e==null?void 0:e.id,label:e==null?void 0:e.name}))]})}),key:"assigned_to"},{title:"Status",key:"status"},{title:"Date Filed",key:"created_at"},{title:t.jsx("div",{className:"flex gap-3 items-center justify-center",children:t.jsx(f,{allowClear:!0,className:"w-36 mr-4",showSearch:!0,placeholder:"Category",optionFilterProp:"label",defaultValue:(r==null?void 0:r.name)??null,onChange:N,options:S})}),key:"category_id"},{title:"Action",key:"action"}],p=i==null?void 0:i.data.map(e=>{var a,s,h;return{...e,name:((a=e==null?void 0:e.user)==null?void 0:a.name)??"",assigned_to:((s=e==null?void 0:e.assigned_to)==null?void 0:s.name)??"",category_id:((h=e==null?void 0:e.category)==null?void 0:h.name)??"",created_at:F(e.created_at).format("LLL"),status:t.jsxs(t.Fragment,{children:[e.status==="Assigned"&&t.jsxs("div",{className:"bg-blue-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(L,{className:"w-4 h-4"})," Assigned"]}),e.status==="Pending"&&t.jsxs("div",{className:"bg-yellow-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(U,{})," Pending"]}),e.status==="Closed"&&t.jsxs("div",{className:"bg-green-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx($,{className:"w-4 h-4"})," Closed"]}),e.status==="Declined"&&t.jsxs("div",{className:"bg-red-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(A,{className:"w-4 h-4"})," Declined"]}),e.isUrgent==="true"&&t.jsxs("div",{className:"bg-red-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border border-transparent animate-border-glow",children:[t.jsx(I,{className:"w-4 h-4 mr-1"}),"Urgent"]})]}),action:t.jsx("div",{className:"flex gap-4",children:t.jsxs("button",{onClick:()=>d.visit("/admin/tickets/"+e.id+"/details"),type:"button",class:"text-white bg-[#2557D6] gap-2 hover:bg-[#2557D6]/90 focus:ring-4 focus:ring-[#2557D6]/50 focus:outline-none font-medium rounded-lg text-sm px-5 py-1.5 text-center inline-flex items-center",children:[t.jsx(z,{className:"size-5 "}),"View Ticket"]})})}}),x=((e,a)=>new URLSearchParams(e.split("?")[1]).get(a))(y,"page"),l=x?parseInt(x,10):1,k=e=>{const a=new URLSearchParams(window.location.search);a.set("page",e);const s=window.location.pathname+"?"+a.toString();d.visit(s)},c=10;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(D,{}),t.jsx(T,{})]}),t.jsxs("div",{className:"flex flex-col items-center justify-between h-[85vh] w-full",children:[t.jsx(R,{pagination:!1,setDataChecked:j,dataChecked:w,columns:P,data:p,isCheckbox:!0,dataSource:i.data}),t.jsx("div",{className:"w-full mt-3.5",children:i.total>0?`Showing ${(l-1)*c+1} to ${Math.min(l*c,i.total)} of ${i.total} entries`:"No entries available"}),t.jsx(_,{onChange:k,defaultCurrent:l,total:i.total,pageSize:c,showSizeChanger:!1,data:i})]})]})}export{ce as default};
