import{r as p,u as l,j as a,s as o}from"./app-BWFyE4ss.js";import"./postcss-DtIggXEU.js";import{c as y}from"./tickets-thunk-B40XBhdv.js";import{S as d,I as j,T as k,R as C}from"./textarea-SQ9ivcoo.js";import{a as S}from"./it-thunk-Bk0o8g8O.js";import{a as T}from"./category-thunk-L-vebRj1.js";import{s as w}from"./app-thunk-B62njjGP.js";import{s as O}from"./index-CTvRPQmm.js";import{M as U}from"./index-DTZvexkm.js";import{U as I}from"./index-BdfMOrE0.js";import{B as N}from"./index-CtWlwBr3.js";import"./ticket-service-CX4RUc1e.js";import"./index-C0ihIYTl.js";import"./EyeOutlined-CiK1Xws7.js";function K({isOpen:g,closeModal:c}){const[f,u]=p.useState(!1),[t,i]=p.useState({}),{users:r}=l(e=>e.it),{user:m}=l(e=>e.app),[h,x]=O.useMessage(),{allCategories:v}=l(e=>e.category);function b(e){return!(e==null?void 0:e.some(n=>n.status!=="done"))}async function _(e){e.preventDefault(),u(!0);const s=new FormData;if(s.append("assigned_to",t.assigned_to),s.append("category_id",t.category_id),s.append("details",t.details),s.append("status",t.status),s.append("isUrgent",t.isUrgent),s.append("user_id",m.id),s.append("others",t.others),b(t.files)&&t.files)for(let n=0;n<t.files.length;n++)t.files[n].name!=="uploaded"&&t.files[n].status=="done"&&s.append("files[]",t.files[n].originFileObj);await o.dispatch(y(s)),await o.dispatch(S(m.id)),await o.dispatch(w()),t.category_id=="Others"&&o.dispatch(T()),h.success("Created Successfully!"),i({}),c(),u(!1)}return a.jsxs(a.Fragment,{children:[x,a.jsx(U,{title:"Ticket Information",okText:"Submit",onOk:_,confirmLoading:f,open:g,onCancel:c,children:a.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[a.jsxs("div",{className:"grid md:gap-6",children:[a.jsx(d,{value:t.category_id,label:"Category",name:"category_id",onChange:e=>i({...t,category_id:e.target.value}),options:v.map(e=>({label:e.name,value:e.id}))}),t.category_id=="Others"&&a.jsx(j,{onChange:e=>i({...t,others:e.target.value}),value:t.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),a.jsx("div",{className:"grid md:gap-6 mt-4 ",children:a.jsx(k,{onChange:e=>i({...t,details:e.target.value}),value:t.details??"",required:"true",name:"details",label:"Request Details",type:"text"})}),a.jsx("div",{className:"relative z-0 w-full mb-6 group mt-4 ",children:a.jsx(d,{value:t.assigned_to,label:"Select IT Personnel",name:"assigned_to",onChange:e=>i({...t,assigned_to:e.target.value}),options:r==null?void 0:r.data.map(e=>({label:e.name,value:e.id}))})}),a.jsx("div",{className:"relative z-0 w-full mb-6 group",children:a.jsx(d,{value:t.status,label:"Select IT Personnel",name:"status",onChange:e=>i({...t,status:e.target.value}),options:[{name:"Pending",value:"Pending"},{name:"Assigned",value:"Assigned"},{name:"Ongoing",value:"Ongoing"},{name:"Closed",value:"Closed"}].map(e=>({label:e.name,value:e.id}))})}),a.jsx(I,{onChange:e=>i({...t,files:e.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:a.jsx(N,{icon:a.jsx(C,{}),children:"Upload"})}),a.jsxs("div",{class:"flex items-center my-4",children:[a.jsx("input",{id:"default-checkbox",type:"checkbox",value:"",name:"isUrgent",onChange:e=>i({...t,[e.target.name]:JSON.stringify(e.target.checked)}),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500   focus:ring-2 "}),a.jsx("label",{for:"default-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Is Urgent"})]})]})})]})}export{K as default};
