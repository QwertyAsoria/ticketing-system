import{r as u,u as n,j as s,s as o}from"./app-BCqQGQTW.js";import"./postcss-Cx_NYme7.js";import{c as _}from"./tickets-thunk-D7myDgLa.js";import{S as b,I as j,T as k,R as v}from"./textarea-BAKTju4U.js";import{a as C}from"./it-thunk-BOgwGr9f.js";import{a as S}from"./category-thunk-I1grUsAo.js";import{s as U}from"./app-thunk-YXQRhldc.js";import{s as T}from"./index-tlomZyv1.js";import{M as w}from"./index-BCcGIS-0.js";import{U as O}from"./index-DYiX8ziT.js";import{B as I}from"./index-CXaRMW6H.js";import"./ticket-service-PGo-BUdB.js";import"./index-CReEcKuY.js";import"./EyeOutlined-BOHPBdkQ.js";function z({isOpen:p,closeModal:l}){const[m,d]=u.useState(!1),[t,r]=u.useState({status:"Pending"});n(e=>e.it);const{user:c}=n(e=>e.app),[g,f]=T.useMessage(),{allCategories:h}=n(e=>e.category);function x(e){return!(e==null?void 0:e.some(i=>i.status!=="done"))}async function y(e){e.preventDefault(),d(!0);const a=new FormData;if(a.append("assigned_to",t.assigned_to),a.append("category_id",t.category_id),a.append("details",t.details),a.append("status",t.status),a.append("isUrgent",t.isUrgent),a.append("user_id",c.id),a.append("others",t.others),x(t.files)&&t.files)for(let i=0;i<t.files.length;i++)t.files[i].name!=="uploaded"&&t.files[i].status=="done"&&a.append("files[]",t.files[i].originFileObj);await o.dispatch(_(a)),await o.dispatch(C(c.id)),await o.dispatch(U(a)),t.category_id=="Others"&&o.dispatch(S()),g.success("Created Successfully!"),r({}),l(),d(!1)}return s.jsxs(s.Fragment,{children:[f,s.jsx(w,{title:"Ticket Information",okText:"Submit",onOk:y,confirmLoading:m,open:p,onCancel:l,children:s.jsxs("form",{className:"max-w-full mx-auto mt-4 ",children:[s.jsxs("div",{className:"grid md:gap-6",children:[s.jsx(b,{value:t.category_id,label:"Category",name:"category_id",onChange:e=>r({...t,category_id:e.target.value}),options:h.map(e=>({label:e.name,value:e.id}))}),t.category_id=="Others"&&s.jsx(j,{onChange:e=>r({...t,others:e.target.value}),value:t.others??"",required:"true",name:"others",label:"Other Request",type:"text"})]}),s.jsx("div",{className:"grid md:gap-6 mt-4 ",children:s.jsx(k,{onChange:e=>r({...t,details:e.target.value}),value:t.details??"",required:"true",name:"details",label:"Request Details",type:"text"})}),s.jsx(O,{onChange:e=>r({...t,files:e.fileList}),multiple:!0,action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",className:"upload-list-inline",children:s.jsx(I,{icon:s.jsx(v,{}),children:"Upload"})}),s.jsxs("div",{class:"flex items-center my-4",children:[s.jsx("input",{id:"default-checkbox",type:"checkbox",value:"",name:"isUrgent",onChange:e=>r({...t,[e.target.name]:JSON.stringify(e.target.checked)}),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500   focus:ring-2 "}),s.jsx("label",{for:"default-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Is Urgent"})]})]})})]})}export{z as default};
