import{u as m,r as C,j as t,y as d}from"./app-B5ieftkc.js";import{h as F}from"./moment-C5S46NFB.js";import{T as R}from"./table-R_phgbrm.js";import{P as _}from"./pagination-DW5sYKfr.js";import D from"./tickets-search-section-B6mQUeN0.js";import T from"./tickets-filter-by-date-BUgstwXc.js";import{S as f}from"./index-Qz9kPnUO.js";import{F as L,R as U,a as $}from"./FieldTimeOutlined-Dmuz4bY3.js";import{F as I}from"./XMarkIcon-DuL67Uca.js";import{F as z}from"./ExclamationTriangleIcon-hxgn1k8O.js";import{F as A}from"./TicketIcon-HPCb1-RV.js";import"./index-ZzUNO1uO.js";import"./AntdIcon-BaWIpQa7.js";import"./index-23ywhTEh.js";import"./PurePanel-AMGpAK6L.js";import"./motion-DVuORPSj.js";import"./button-DL2IWGY8.js";import"./CheckOutlined-DY2WNWUb.js";import"./index-ER-9FXd4.js";import"./roundedArrow-c-BS2pSb.js";import"./motion-BOUohYk8.js";function re(){var h;const{tickets:o}=m(e=>e.tickets),{categories:n}=m(e=>e.category),{users:s}=m(e=>e.it),[w,y]=C.useState([]),j=window.location.pathname+window.location.search;console.log("categoriescategories",n);const b=new URL(window.location.href),u=new URLSearchParams(b.search);u.get("page");const v=u.get("category_id")||null;function N(e){const a=new URLSearchParams(window.location.search);a.set("category_id",e||"null"),d.visit(window.location.pathname+"?"+a.toString())}const S=Object.values(n.data).map(e=>({label:e.name,value:e.id})),r=Object.values(n.data).find(e=>e.id==v),P=[{title:"Name of Requestor",key:"name"},{title:"Ticket No.",key:"ticket_id"},{title:t.jsx("div",{className:"flex gap-3 items-center justify-center",children:t.jsx(f,{allowClear:!0,className:"w-40 mr-4",showSearch:!0,placeholder:"I.T Personnel",optionFilterProp:"label",defaultValue:(s==null?void 0:s.name)??null,onChange:e=>setData({...x,assigned_to:e}),options:[{value:"",label:"SCIT Department"},...(h=s==null?void 0:s.data)==null?void 0:h.map(e=>({value:e==null?void 0:e.id,label:e==null?void 0:e.name}))]})}),key:"assigned_to"},{title:"Status",key:"status"},{title:"Date Filed",key:"created_at"},{title:t.jsx("div",{className:"flex gap-3 items-center justify-center",children:t.jsx(f,{allowClear:!0,className:"w-36 mr-4",showSearch:!0,placeholder:"Category",optionFilterProp:"label",defaultValue:(r==null?void 0:r.name)??null,onChange:N,options:S})}),key:"category_id"},{title:"Action",key:"action"}],x=o==null?void 0:o.data.map(e=>{var a,i,p;return{...e,name:((a=e==null?void 0:e.user)==null?void 0:a.name)??"",assigned_to:((i=e==null?void 0:e.assigned_to)==null?void 0:i.name)??"",category_id:((p=e==null?void 0:e.category)==null?void 0:p.name)??"",created_at:F(e.created_at).format("LLL"),status:t.jsxs(t.Fragment,{children:[e.status==="Assigned"&&t.jsxs("div",{className:"bg-blue-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(L,{className:"w-4 h-4"})," Assigned"]}),e.status==="Pending"&&t.jsxs("div",{className:"bg-yellow-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(U,{})," Pending"]}),e.status==="Closed"&&t.jsxs("div",{className:"bg-green-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx($,{className:"w-4 h-4"})," Closed"]}),e.status==="Declined"&&t.jsxs("div",{className:"bg-red-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border-gray-500",children:[t.jsx(I,{className:"w-4 h-4"})," Declined"]}),e.isUrgent==="true"&&t.jsxs("div",{className:"bg-red-600 text-white text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 border border-transparent animate-border-glow",children:[t.jsx(z,{className:"w-4 h-4 mr-1"}),"Urgent"]})]}),action:t.jsx("div",{className:"flex gap-4",children:t.jsxs("button",{onClick:()=>d.visit("/admin/tickets/"+e.id+"/details"),type:"button",class:"text-white bg-[#2557D6] gap-2 hover:bg-[#2557D6]/90 focus:ring-4 focus:ring-[#2557D6]/50 focus:outline-none font-medium rounded-lg text-sm px-5 py-1.5 text-center inline-flex items-center",children:[t.jsx(A,{className:"size-5 "}),"View Ticket"]})})}}),g=((e,a)=>new URLSearchParams(e.split("?")[1]).get(a))(j,"page"),l=g?parseInt(g,10):1,k=e=>{const a=new URLSearchParams(window.location.search);a.set("page",e);const i=window.location.pathname+"?"+a.toString();d.visit(i)},c=10;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-1 justify-between",children:[t.jsx(D,{}),t.jsx(T,{})]}),t.jsxs("div",{className:"flex flex-col items-center justify-between h-[85vh] w-full",children:[t.jsx(R,{pagination:!1,setDataChecked:y,dataChecked:w,columns:P,data:x,isCheckbox:!0,dataSource:o.data}),t.jsx("div",{className:"w-full mt-3.5",children:o.total>0?`Showing ${(l-1)*c+1} to ${Math.min(l*c,o.total)} of ${o.total} entries`:"No entries available"}),t.jsx(_,{onChange:k,defaultCurrent:l,total:o.total,pageSize:c,showSizeChanger:!1,data:o})]})]})}export{re as default};
